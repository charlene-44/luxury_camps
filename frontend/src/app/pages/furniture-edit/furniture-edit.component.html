<!-- frontend\src\app\pages\furniture-edit\furniture-edit.component.html -->

<div class="p-8 max-w-2xl mx-auto">
  <h1 class="text-4xl font-bold mb-6">Modifier le Meuble</h1>
  <div *ngIf="error" class="text-red-600 mb-4">{{ error }}</div>
  <form [formGroup]="furnitureForm" (ngSubmit)="submitForm()">
    <div class="mb-4">
      <label class="block font-medium">
        Name
        <input
          type="text"
          formControlName="name"
          class="w-full p-2 border rounded"
        />
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Description
        <textarea
          formControlName="description"
          class="w-full p-2 border rounded"
        ></textarea>
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Size
        <input
          type="text"
          formControlName="size"
          class="w-full p-2 border rounded"
        />
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Colour
        <input
          type="text"
          formControlName="colour"
          class="w-full p-2 border rounded"
        />
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Quantity
        <input
          type="number"
          formControlName="quantity"
          class="w-full p-2 border rounded"
        />
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Price
        <input
          type="number"
          step="0.01"
          formControlName="price"
          class="w-full p-2 border rounded"
        />
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Status
        <select formControlName="status" class="w-full p-2 border rounded">
          <option value="">Select status</option>
          <option *ngFor="let status of statuses" [value]="status">
            {{ status }}
          </option>
        </select>
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Type
        <select formControlName="typeId" class="w-full p-2 border rounded">
          <option value="">Select type</option>
          <option *ngFor="let type of furnitureTypes" [value]="type.id">
            {{ type.name }}
          </option>
        </select>
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Materials
        <div *ngFor="let material of materials" class="flex items-center">
          <input
            type="checkbox"
            [value]="material.id"
            (change)="onMaterialChange($event)"
            [checked]="
              (furnitureForm.get('materialIds')?.value || []).indexOf(
                material.id
              ) !== -1
            "
            class="mr-2"
          />
          <span>{{ material.name }}</span>
        </div>
      </label>
    </div>
    <div class="mb-4">
      <label class="block font-medium">
        Image URLs
        <div formArrayName="imageUrls">
          <div
            *ngFor="let ctrl of imageUrls.controls; let i = index"
            class="flex items-center space-x-2 mb-2"
          >
            <input
              [formControlName]="i"
              type="text"
              placeholder="Image URL"
              class="w-full p-2 border rounded"
            />
            <button
              type="button"
              (click)="removeImageUrl(i)"
              class="bg-red-600 text-white px-2 py-1 rounded"
            >
              Remove
            </button>
          </div>
        </div>
      </label>
      <button
        type="button"
        (click)="addImageUrl()"
        class="bg-cyan-950 text-white px-4 py-2 rounded mt-2"
      >
        Add Image
      </button>
    </div>
    <div class="flex justify-end">
      <button
        type="submit"
        [disabled]="loading"
        class="bg-cyan-950 text-white px-4 py-2 rounded"
      >
        {{ loading ? "Submitting..." : "Modifier le Meuble" }}
      </button>
    </div>
  </form>
</div>
